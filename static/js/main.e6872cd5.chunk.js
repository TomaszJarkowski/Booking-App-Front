(this["webpackJsonpbooking-app-front"]=this["webpackJsonpbooking-app-front"]||[]).push([[0],{22:function(e,t,a){e.exports=a.p+"static/media/undraw_Booking_re_gw4j.16babcc0.svg"},23:function(e,t,a){e.exports=a.p+"static/media/404.59156c30.svg"},25:function(e,t,a){e.exports=a(37)},30:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(14),c=a.n(o),l=(a(30),a(4)),s=a.n(l),u=a(10),m=a(8),i=a(1),h=a(2),d=a(3),p=Object(n.createContext)(null),E=function(){var e=Object(n.useContext)(p),t=e.userData,a=e.setUserData,o=Object(d.g)();return r.a.createElement("div",{className:"auth-options"},t.user?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"user",onClick:function(){return o.push("/dashboard")}},r.a.createElement("i",{className:"fas fa-user"}),r.a.createElement("p",null,t.user.userName)),r.a.createElement("button",{onClick:function(){a({token:void 0,user:void 0}),localStorage.setItem("auth-token","")},className:"button-secondary button-logout"},"Log out")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(){return o.push("/login")},className:"button-secondary button-login"},"Log in"),r.a.createElement("button",{onClick:function(){return o.push("/register")},className:"button-primary button-register"},"Register")))},b=function(){return r.a.createElement("nav",null,r.a.createElement("div",{className:"container"},r.a.createElement(h.b,{to:"/"},r.a.createElement("h1",{className:"logo"},r.a.createElement("i",{className:"fas fa-utensils"}),"Booking App")),r.a.createElement(E,null)))},f=function(e){var t=e.children,a=Object(d.g)(),n=function(e){e.stopPropagation(),a.goBack()};return Object(o.createPortal)(r.a.createElement("div",{className:"modal__wrapper",onClick:n},r.a.createElement("div",{className:"modal__content",onClick:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:"modal__closeIcon",onClick:n},"X"),t)),document.querySelector("#modal"))},g=function(e){var t=e.children,a=e.onClick;return r.a.createElement("button",{className:"button button-danger",type:"submit",onClick:a},t)},v=function(e){return r.a.createElement(f,null,r.a.createElement("div",{className:"accept-modal"},r.a.createElement("h2",null,"Are you sure you want to delete this reservation?"),r.a.createElement(g,{onClick:e.removeBook},"YES")))},w=a(24),O=(new Date).getTime(),j=function(e){var t=Object(w.a)(e.books);return t.sort((function(e,t){return new Date("".concat(t.dateDay,"-").concat(t.dateMonth,"-").concat(t.dateYear,"-").concat(t.hour))-new Date("".concat(e.dateDay,"-").concat(e.dateMonth,"-").concat(e.dateYear,"-").concat(e.hour))})).reverse(),t.map((function(t){var a=new Date("".concat(t.dateDay,"-").concat(t.dateMonth,"-").concat(t.dateYear,"-").concat(t.hour)).getTime();return r.a.createElement("div",{className:"book",style:a>O&&new Date(O).toString().slice(0,15)===new Date(a).toString().slice(0,15)?{borderBottom:"solid 8px #11998e"}:a<O?{borderBottom:"solid 8px rgb(219, 46, 46)"}:null,key:Math.random()},r.a.createElement("h3",{className:"date"},t.dateDay,"-",t.dateMonth,"-",t.dateYear),r.a.createElement("h3",{className:"hour"},t.hour),r.a.createElement("h3",{className:"name"},t.firstName," ",t.lastName),r.a.createElement("h3",{className:"seats"},t.numberOfSeats),r.a.createElement(h.c,{to:"/dashboard/accept",onClick:function(){return e.setElToRemove(t)},className:"fas fa-times"}))}))},y=function(e){var t=e.children,a=e.onClick;return r.a.createElement("button",{className:"button button-primary",onClick:a},t)},k=function(){var e=Object(d.g)();return r.a.createElement("div",{className:"zero-books"},r.a.createElement("h2",null,"You don't have any reservations"," ",r.a.createElement("span",{role:"img","aria-label":"crying"},"\ud83d\ude22")),r.a.createElement(y,{onClick:function(){e.push("/booking")}},"Booking"))},N=function(){return r.a.createElement("div",{className:"spinner"},r.a.createElement("div",{className:"bounce1"}),r.a.createElement("div",{className:"bounce2"}),r.a.createElement("div",{className:"bounce3"}))},S=function(e){var t=e.error;return r.a.createElement("p",{className:"error-message"},t)},C=function(e){var t=e.children;return r.a.createElement("button",{className:"button button-disabled",disabled:!0},t)},x=function(e){var t=Object(n.useState)(""),a=Object(i.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)(!0),u=Object(i.a)(l,2),h=u[0],d=u[1],p=Object(n.useState)(""),E=Object(i.a)(p,2),b=E[0],v=E[1],w=Object(n.useState)(!1),O=Object(i.a)(w,2),j=O[0],y=O[1],k=function(){var e=Object(m.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),y(!0),a=localStorage.getItem("auth-token"),fetch("https://booking-app-back.herokuapp.com/users/deleteUser",{method:"DELETE",headers:{"x-auth-token":a}}).then((function(e){return e.json()})).then((function(e){y(!1),e.error?(h(!0),v(e.error)):window.location.reload()})).catch((function(e){y(!1),h(!0),v(e.message)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){d("agree"!==o)};return r.a.createElement(f,null,r.a.createElement("form",{onSubmit:k,className:"delete-account modal-form"},r.a.createElement("h2",null,"Are you absolutely sure?"),r.a.createElement("h3",null,"This action cannot be undone. This will permanently delete the profile, booking, history."),r.a.createElement("label",null,"Please type ",r.a.createElement("strong",null,"agree")," to confirm."),r.a.createElement("input",{type:"text",value:o,onKeyUp:function(){return x()},onKeyDown:function(){return x()},onChange:function(e){x(),c(e.target.value)}}),j?r.a.createElement(N,null):null,h?r.a.createElement(S,{error:b}):null,h?r.a.createElement(C,null,"delete"):r.a.createElement(g,null,"delete ")))},D=/^[a-zA-Z0-9\u0104\u0105\u0118\u0119\xd3\xf3\u0141\u0142\u015a\u015b\u0104\u0105\u017b\u017c\u0179\u017a\u0106\u0107\u0143\u0144]*$/gm,P=function(e){if(!e)throw new Error("Please enter username");if(!e.match(D))throw new Error("Username must contain only numbers and letters");if(e.length<4)throw new Error("The minimum username length is: 4")},T=function(){var e=Object(n.useContext)(p).userData,t=Object(n.useState)(""),a=Object(i.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)(""),s=Object(i.a)(l,2),u=s[0],m=s[1],h=Object(n.useState)(!0),d=Object(i.a)(h,2),E=d[0],b=d[1],g=Object(n.useState)(!1),v=Object(i.a)(g,2),w=v[0],O=v[1],j=function(){b(!1);try{P(o)}catch(e){b(!0),m(e.message)}};return r.a.createElement(f,null,r.a.createElement("form",{className:"change-username modal-form",onSubmit:function(t){t.preventDefault(),O(!0),fetch("https://booking-app-back.herokuapp.com/users/changeUsername",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({changeUsername:o,id:e.user.id})}).then((function(e){return e.json()})).then((function(e){O(!1),e.error?(m(e.error),b(!0)):(b(!1),window.location.reload())})).catch((function(e){O(!1),m(e.message),b(!0)}))}},r.a.createElement("h2",null,"Change username"),r.a.createElement("label",null,"New Username"),r.a.createElement("input",{type:"text",value:o,name:"username",id:"changeusername",onKeyUp:function(){return j()},onChange:function(e){j(),c(e.target.value)}}),w?r.a.createElement(N,null):null,E?r.a.createElement(S,{error:u}):null,E?r.a.createElement(C,null,"Change username"):r.a.createElement(y,null,"Change username")))},U=/^[a-zA-Z0-9\u0104\u0105\u0118\u0119\xd3\xf3\u0141\u0142\u015a\u015b\u0104\u0105\u017b\u017c\u0179\u017a\u0106\u0107\u0143\u0144]*$/gm,F=function(e,t,a){if(!e)throw new Error("Please enter old password");if(!t)throw new Error("Please enter new password");if(!a)throw new Error("Please enter confirm new password");if(!e.match(U))throw new Error("Old password must contain only numbers and letters");if(!t.match(U))throw new Error("New password must contain only numbers and letters");if(!a.match(U))throw new Error("Confirm new password must contain only numbers and letters");if(e.length<7)throw new Error("The minimum old password length is: 7");if(t.length<7)throw new Error("The minimum new password length is: 7");if(a.length<7)throw new Error("The minimum confirm new password length is: 7");if(t!==a)throw new Error("New Password must be the same as the confirm new password")},_=function(){var e=Object(n.useContext)(p).userData,t=Object(n.useState)(""),a=Object(i.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)(""),s=Object(i.a)(l,2),u=s[0],m=s[1],h=Object(n.useState)(""),d=Object(i.a)(h,2),E=d[0],b=d[1],g=Object(n.useState)(!0),v=Object(i.a)(g,2),w=v[0],O=v[1],j=Object(n.useState)(""),k=Object(i.a)(j,2),x=k[0],D=k[1],P=Object(n.useState)(!1),T=Object(i.a)(P,2),U=T[0],_=T[1],A=function(){O(!1);try{F(o,u,E)}catch(e){O(!0),D(e.message)}};return r.a.createElement(f,null,r.a.createElement("form",{className:"change-username modal-form",onSubmit:function(t){t.preventDefault(),_(!0),fetch("https://booking-app-back.herokuapp.com/users/changePassword",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldPassword:o,newPassword:u,id:e.user.id})}).then((function(e){return e.json()})).then((function(e){_(!1),e.error?(D(e.error),O(!0)):O(!1)})).catch((function(e){_(!1),D(e.message),O(!0)}))}},r.a.createElement("h2",null,"Change password"),r.a.createElement("label",null,"Old password"),r.a.createElement("input",{type:"password",onKeyUp:A,onChange:function(e){A(),c(e.target.value)}}),r.a.createElement("label",null,"New password"),r.a.createElement("input",{type:"password",onKeyUp:A,onChange:function(e){A(),m(e.target.value)}}),r.a.createElement("label",null,"Confirm new password"),r.a.createElement("input",{type:"password",onKeyUp:A,onChange:function(e){A(),b(e.target.value)}}),U?r.a.createElement(N,null):null,w?r.a.createElement(S,{error:x}):null,w?r.a.createElement(C,null,"Change username"):r.a.createElement(y,null,"Change password")))},A=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)({}),l=Object(i.a)(c,2),u=l[0],h=l[1],E=Object(n.useState)(!1),b=Object(i.a)(E,2),f=b[0],w=b[1],O=Object(d.g)(),y=Object(n.useContext)(p).userData;Object(n.useEffect)((function(){var e=function(){var e=Object(m.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),e.next=3,fetch("https://booking-app-back.herokuapp.com/book/get",{method:"POST",body:JSON.stringify({userId:y.user.id}),headers:{"Content-Type":"application/json"}});case 3:return t=e.sent,e.next=6,t.json();case 6:(a=e.sent)&&o(a),w(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();y.user&&e()}),[y.user]);var S=function(){fetch("https://booking-app-back.herokuapp.com/book",{method:"DELETE",body:JSON.stringify({id:u._id}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){o(a.filter((function(t){return t._id!==e._id}))),O.push("/dashboard")})).catch((function(e){alert(e.message)}))};return r.a.createElement(d.b,{render:function(){return y.user?r.a.createElement("div",{className:"page-dashboard"},r.a.createElement("div",{className:"container"},r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/dashboard/accept"},r.a.createElement(v,{removeBook:S})),r.a.createElement(d.b,{path:"/dashboard/changeUsername"},r.a.createElement(T,null)),r.a.createElement(d.b,{path:"/dashboard/deleteAccount"},r.a.createElement(x,null)),r.a.createElement(d.b,{path:"/dashboard/changePassword"},r.a.createElement(_,null))),r.a.createElement("div",{className:"dashboard__myData"},r.a.createElement("h1",null,"My Data"),r.a.createElement("h2",null,"Email: ",y.user.email),r.a.createElement("h2",null,"Username: ",y.user.userName),r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{className:"button button-secondary",onClick:function(){return O.push("/dashboard/changeUsername")}},"Change user name"),r.a.createElement("button",{className:"button button-secondary",onClick:function(){return O.push("/dashboard/changePassword")}},"Change password"),r.a.createElement(g,{onClick:function(){return O.push("/dashboard/deleteAccount")}},"Delete account"))),r.a.createElement("div",{className:"dashboard__books"},r.a.createElement("h1",null,"My Books"),r.a.createElement("div",{className:"colors"},r.a.createElement("div",{className:"color today"},r.a.createElement("h3",null,"Reservations for today"),r.a.createElement("div",null)),r.a.createElement("div",{className:"color dedline"},r.a.createElement("h3",null,"After the deadline"),r.a.createElement("div",null)),r.a.createElement("div",{className:"color fewDays"},r.a.createElement("h3",null,"Other reservations"),r.a.createElement("div",null))),f?r.a.createElement(N,null):a.length?r.a.createElement("div",{className:"books"},r.a.createElement(j,{books:a,setElToRemove:h})):r.a.createElement(k,null)))):r.a.createElement(d.a,{to:"/login"})}})},B=Object(n.createContext)(null),K=/^[a-zA-Z0-9\u0104\u0105\u0118\u0119\xd3\xf3\u0141\u0142\u015a\u015b\u0104\u0105\u017b\u017c\u0179\u017a\u0106\u0107\u0143\u0144]*$/gm,M=function(e,t){if(!e.match(K))throw new Error("Name is not correct");if(!t.match(K))throw new Error("Last name is not correct");if(e.length<3)throw new Error("The minimum name length is: 3");if(t.length<3)throw new Error("The minimum last name length is: 3")},z=function(){var e=Object(d.g)();return r.a.createElement("div",{className:"success"},r.a.createElement("h1",null,"Congratulations!"),r.a.createElement("h2",null,"You managed to book a table!"),r.a.createElement(y,{onClick:function(t){e.push("/")}},"Go home"))},I=function(){var e=Object(n.useContext)(B).bookData,t=Object(n.useState)(""),a=Object(i.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)(""),s=Object(i.a)(l,2),m=s[0],h=s[1],d=Object(n.useState)("1"),p=Object(i.a)(d,2),E=p[0],b=p[1],g=Object(n.useState)("10:00"),v=Object(i.a)(g,2),w=v[0],O=v[1],j=Object(n.useState)(!0),k=Object(i.a)(j,2),x=k[0],D=k[1],P=Object(n.useState)(""),T=Object(i.a)(P,2),U=T[0],F=T[1],_=Object(n.useState)(!1),A=Object(i.a)(_,2),K=A[0],I=A[1],Z=Object(n.useState)(!1),Y=Object(i.a)(Z,2),J=Y[0],L=Y[1],$=function(){D(!1);try{M(o,m)}catch(e){D(!0),F(e.message)}};return r.a.createElement(f,null,r.a.createElement("form",{className:"form-time modal-form",onSubmit:function(t){t.preventDefault(),L(!0),fetch("https://booking-app-back.herokuapp.com/book",{method:"POST",body:JSON.stringify(Object(u.a)(Object(u.a)({},e),{},{firstName:o,lastName:m,numberOfSeats:E,hour:w})),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){L(!1),e.error?(F(e.error),D(!0)):I(!0)})).catch((function(e){L(!1),F("Failed to fetch"),D(!0)}))}},K?r.a.createElement(z,null):null,r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Complete the form"),r.a.createElement("h4",null,e.dateDay,"-",e.dateMonth,"-",e.dateYear),r.a.createElement("h4",null,e.email),r.a.createElement("label",{htmlFor:"firstName"},"First Name ",r.a.createElement("span",{className:"star"},"*")),r.a.createElement("input",{type:"text",id:"firstName",onKeyUp:$,onKeyDown:$,onChange:function(e){c(e.target.value),$()}}),r.a.createElement("label",{htmlFor:"lastName"},"Last Name ",r.a.createElement("span",{className:"star"},"*")),r.a.createElement("input",{type:"text",id:"lastName",onKeyUp:$,onKeyDown:$,onChange:function(e){h(e.target.value),$()}}),r.a.createElement("div",{className:"details"},r.a.createElement("label",{htmlFor:"numberOfSeats"},"Seats ",r.a.createElement("span",{className:"star"},"*")),r.a.createElement("select",{name:"numberOfSeats",id:"numberOfSeats",onChange:function(e){return b(e.target.value)}},r.a.createElement("option",{value:"1"},"1"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"3"},"3"),r.a.createElement("option",{value:"4"},"4"),r.a.createElement("option",{value:"5"},"5"),r.a.createElement("option",{value:"6"},"6"),r.a.createElement("option",{value:"7"},"7"),r.a.createElement("option",{value:"8"},"8"),r.a.createElement("option",{value:"9"},"9")),r.a.createElement("label",{htmlFor:"hour"},"Hour ",r.a.createElement("span",{className:"star"},"*")),r.a.createElement("select",{name:"hour",id:"hour",onChange:function(e){return O(e.target.value)}},r.a.createElement("option",{value:"10:00"},"10:00"),r.a.createElement("option",{value:"11:00"},"11:00"),r.a.createElement("option",{value:"12:00"},"12:00"),r.a.createElement("option",{value:"13:00"},"13:00"),r.a.createElement("option",{value:"14:00"},"14:00"),r.a.createElement("option",{value:"15:00"},"15:00"),r.a.createElement("option",{value:"16:00"},"16:00"),r.a.createElement("option",{value:"17:00"},"17:00"),r.a.createElement("option",{value:"18:00"},"18:00"),r.a.createElement("option",{value:"19:00"},"19:00"),r.a.createElement("option",{value:"20:00"},"20:00"))),J?r.a.createElement(N,null):null,x?r.a.createElement(S,{error:U}):null,x?r.a.createElement(C,null,"Book a table"):r.a.createElement(y,null,"Book a table"))))},Z=[{shortCut:"Sun",name:"Sunday"},{shortCut:"Mon",name:"Monday"},{shortCut:"Tue",name:"Tuesday"},{shortCut:"Wed",name:"Wednesday"},{shortCut:"Thu",name:"Thursday"},{shortCut:"Fri",name:"Friday"},{shortCut:"Sat",name:"Saturday"}],Y=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useContext)(B),l=c.bookData,s=c.setBookData,m=Object(n.useContext)(p).userData;Object(n.useEffect)((function(){for(var e=[],t=1;t<18;t++){if(11!==t){var a=new Date(Date.now()+1*t*864e5).toString();e.push({year:a.slice(11,15),month:a.slice(4,7),day:a.slice(8,10),name:a.slice(0,3)})}o(e)}}),[]);var E=function(e){var t=e.name;return Z.map((function(e){return e.shortCut===t?r.a.createElement("h2",{key:Math.floor(Math.random())},e.name):null}))},b=function(){return a.map((function(e){return r.a.createElement(h.c,{to:"/booking/form",key:"".concat(e.day,"-").concat(e.month,"-").concat(e.year),onClick:function(){return function(e){s(Object(u.a)(Object(u.a)({},l),{},{userId:m.user.id,dateDay:e.day,dateMonth:e.month,dateYear:e.year,email:m.user.email}))}(e)}},r.a.createElement("div",{className:"tile"},r.a.createElement("h1",null,e.day),r.a.createElement(E,{name:e.name}),r.a.createElement("h2",null,e.month),r.a.createElement("h3",null,e.year)))}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"board"},r.a.createElement(b,null)),r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/booking/form"},r.a.createElement(I,null))))},J=function(){var e=Object(n.useContext)(p).userData,t=function(){return r.a.createElement("div",{className:"page-booking"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"Booking"),r.a.createElement("h2",null,"Select the day and hour and we will reserve a table for you \u2764"),r.a.createElement(Y,null)))};return r.a.createElement(d.b,{render:function(){return e.user?r.a.createElement(t,null):r.a.createElement(d.a,{to:"/login"})}})},L=a(22),$=a.n(L),R=function(){var e=Object(d.g)();return r.a.createElement("div",{className:"page-home"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"content"},r.a.createElement("h1",{className:"home__title"},"Restaurant"),r.a.createElement("h2",{className:"home__description"},"Book a table in the best restaurant in Poland"),r.a.createElement(y,{onClick:function(){return e.push("/booking")}},"booking")),r.a.createElement("img",{src:$.a,alt:"booking_svg",className:"home__svg"})))},V=a(23),W=a.n(V),q=function(){return r.a.createElement("div",{className:"error-page"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"Page not found"),r.a.createElement("img",{src:W.a,alt:"error-page"})))},G=/^[a-zA-Z0-9\u0104\u0105\u0118\u0119\xd3\xf3\u0141\u0142\u015a\u015b\u0104\u0105\u017b\u017c\u0179\u017a\u0106\u0107\u0143\u0144]*$/gm,H=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,X=function(e,t){if(!e)throw new Error("Please enter email");if(!e.match(H))throw new Error("Email is not correct");if(!t)throw new Error("Please enter password");if(!t.match(G))throw new Error("Password must contain only numbers and letters");if(t.length<7)throw new Error("The minimum password length is: 7")},Q=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),l=Object(i.a)(c,2),u=l[0],h=l[1],E=Object(n.useState)(!0),b=Object(i.a)(E,2),f=b[0],g=b[1],v=Object(n.useState)(!1),w=Object(i.a)(v,2),O=w[0],j=w[1],k=Object(n.useState)(""),x=Object(i.a)(k,2),D=x[0],P=x[1],T=Object(n.useContext)(p),U=T.userData,F=T.setUserData,_=Object(d.g)(),A=function(){g(!1);try{X(a,u)}catch(e){P(e.message),g(!0)}},B=function(){var e=Object(m.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,fetch("https://booking-app-back.herokuapp.com/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:return a=e.sent,e.next=7,a.json();case 7:n=e.sent,j(!1),n.error?(P(n.error),g(!0)):(F({token:n.token,user:n.user}),localStorage.setItem("auth-token",n.token),_.push("/booking")),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),j(!1),P("Failed to fetch"),g(!0);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n={email:a,password:u},f||!a||!u){e.next=5;break}return e.next=5,B(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(d.b,{render:function(){return U.user?r.a.createElement(d.a,{to:"/"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"page page-form"},r.a.createElement("div",{className:"form"},r.a.createElement("h2",null,"Login"),r.a.createElement("form",{onSubmit:K},r.a.createElement("label",{htmlFor:"login-email"},"Email"),r.a.createElement("input",{type:"email",id:"login-email",onKeyUp:A,onChange:function(e){o(e.target.value),A()}}),r.a.createElement("label",{htmlFor:"login-password"},"Password"),r.a.createElement("input",{type:"password",id:"login-password",onKeyUp:A,onChange:function(e){h(e.target.value),A()}}),O?r.a.createElement(N,null):null,f?r.a.createElement(S,{error:D}):null,f?r.a.createElement(C,null,"Log in"):r.a.createElement(y,null,"Log in")))))}})},ee=/^[a-zA-Z0-9\u0104\u0105\u0118\u0119\xd3\xf3\u0141\u0142\u015a\u015b\u0104\u0105\u017b\u017c\u0179\u017a\u0106\u0107\u0143\u0144]*$/gm,te=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,ae=function(e,t,a,n){if(!e)throw new Error("Please enter email");if(!e.match(te))throw new Error("Email is not correct");if(!t)throw new Error("Please enter username");if(t.length<4)throw new Error("The minimum username length is: 4");if(!t.match(ee))throw new Error("Username must contain only numbers and letters");if(!a)throw new Error("Please enter password");if(!a.match(ee))throw new Error("Password must contain only numbers and letters");if(a.length<7)throw new Error("The minimum password length is: 7");if(a!==n)throw new Error("Password must be the same as the veryfy password")},ne=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),l=Object(i.a)(c,2),u=l[0],h=l[1],p=Object(n.useState)(""),E=Object(i.a)(p,2),b=E[0],f=E[1],g=Object(n.useState)(""),v=Object(i.a)(g,2),w=v[0],O=v[1],j=Object(n.useState)(!0),k=Object(i.a)(j,2),x=k[0],D=k[1],P=Object(n.useState)(!1),T=Object(i.a)(P,2),U=T[0],F=T[1],_=Object(n.useState)(""),A=Object(i.a)(_,2),B=A[0],K=A[1],M=Object(d.g)(),z=function(){D(!1);try{ae(a,w,u,b)}catch(e){K(e.message),D(!0)}},I=function(){var e=Object(m.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(!0),e.prev=1,e.next=4,fetch("https://booking-app-back.herokuapp.com/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:return a=e.sent,e.next=7,a.json();case 7:n=e.sent,F(!1),n.error?(K(n.error),D(!0)):M.push("/login"),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),F(!1),K("Failed to fetch"),D(!0);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n={email:a,userName:w,password:u,passwordCheck:b},x||!a||!u||!b){e.next=5;break}return e.next=5,I(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"page page-form"},r.a.createElement("div",{className:"form"},r.a.createElement("h2",null,"Register"),r.a.createElement("form",{onSubmit:Z},r.a.createElement("label",{htmlFor:"register-email"},"Email ",r.a.createElement("span",{className:"star"},"*")),r.a.createElement("input",{id:"register-email",type:"email",onKeyUp:z,onChange:function(e){o(e.target.value),z()}}),r.a.createElement("label",{htmlFor:"register-display-name"},"Username ",r.a.createElement("span",{className:"star"},"*")),r.a.createElement("input",{id:"register-display-name",type:"text",onKeyUp:z,onChange:function(e){O(e.target.value),z()}}),r.a.createElement("label",{htmlFor:"register-password"},"Password ",r.a.createElement("span",{className:"star"},"*")),r.a.createElement("input",{id:"register-password",type:"password",onKeyUp:z,onChange:function(e){h(e.target.value),z()}}),r.a.createElement("label",{htmlFor:"register-password-check"},"Veryify password ",r.a.createElement("span",{className:"star"},"*")),r.a.createElement("input",{id:"register-password-check",type:"password",onKeyUp:z,onChange:function(e){f(e.target.value),z()}}),U?r.a.createElement(N,null):null,x?r.a.createElement(S,{error:B}):null,x?r.a.createElement(C,null,"Register"):r.a.createElement(y,null,"Register")))))},re=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:R}),r.a.createElement(d.b,{path:"/home",component:R}),r.a.createElement(d.b,{path:"/login",component:Q}),r.a.createElement(d.b,{path:"/register",component:ne}),r.a.createElement(d.b,{path:"/dashboard",component:A}),r.a.createElement(d.b,{path:"/booking",component:J}),r.a.createElement(d.b,{path:"/",component:q})))},oe=function(){var e=Object(n.useState)({token:void 0,user:void 0}),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)({userId:void 0,dateDay:void 0,dateMonth:void 0,dateYear:void 0,email:void 0,firstName:void 0,lastName:void 0,numberOfSeats:void 0,hour:void 0}),l=Object(i.a)(c,2),d=l[0],E=l[1],f=Object(n.useState)(!1),g=Object(i.a)(f,2),v=g[0],w=g[1];return Object(n.useEffect)((function(){(function(){var e=Object(m.a)(s.a.mark((function e(){var t,n,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),null===(t=localStorage.getItem("auth-token"))&&(localStorage.setItem("auth-token",""),t=""),e.next=5,fetch("https://booking-app-back.herokuapp.com/users/tokenIsValid",{method:"POST",headers:{"x-auth-token":t}});case 5:return n=e.sent,e.next=8,n.json();case 8:if(!e.sent){e.next=17;break}return e.next=12,fetch("https://booking-app-back.herokuapp.com/users",{headers:{"x-auth-token":t}});case 12:return r=e.sent,e.next=15,r.json();case 15:c=e.sent,o(Object(u.a)(Object(u.a)({},a),{},{token:t,user:c}));case 17:w(!1);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,null,r.a.createElement(p.Provider,{value:{userData:a,setUserData:o}},r.a.createElement(B.Provider,{value:{bookData:d,setBookData:E}},v?r.a.createElement(N,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(b,null),r.a.createElement(re,null))))))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(oe,null)),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.e6872cd5.chunk.js.map